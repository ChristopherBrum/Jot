(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-656b"],{"2dk7":function(e,t,a){"use strict";a.r(t);var n=a("r5ur"),l=a.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(r);t.default=l.a},RYnq:function(e,t,a){"use strict";var n=a("lcJ3");a.n(n).a},VqTb:function(e,t,a){"use strict";a.r(t);var n=a("gWtp"),l=a("sw1Y");for(var r in l)["default"].indexOf(r)<0&&function(e){a.d(t,e,(function(){return l[e]}))}(r);a("RYnq");var s=a("KHd+"),i=Object(s.a)(l.default,n.a,n.b,!1,null,"568a7a58",null);i.options.__file="ListDocuments2.vue",t.default=i.exports},gWtp:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return l}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"px-3"},[a("div",{staticClass:"d-flex align-items-center py-2"},[a("h3",{staticClass:"mb-0 text-capitalize"},[e._v("\n      "+e._s(e.collectionName)+"\n    ")]),e._v(" "),a("span",{staticClass:"mx-auto"}),e._v(" "),a("el-dropdown",{staticClass:"mr-4",attrs:{multiple:"","hide-on-click":!1}},[a("span",{staticClass:"el-dropdown-link"},[e._v("\n        Select columns\n        "),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),a("el-dropdown-menu",{staticStyle:{"max-height":"300px",overflow:"auto"},attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-checkbox-group",{on:{input:e.update},model:{value:e.selectedColumns,callback:function(t){e.selectedColumns=t},expression:"selectedColumns"}},e._l(e.allPossibleColumns,(function(t){return a("el-dropdown-item",{key:t,attrs:{label:t,value:t}},[a("el-checkbox",{staticClass:"mb-0 mr-4",attrs:{label:t,disabled:1===e.selectedColumns.length&&e.selectedColumns[0]===t}})],1)})))],1)],1),e._v(" "),a("el-checkbox",{staticClass:"mb-0 mr-4",model:{value:e.isFiltersVisible,callback:function(t){e.isFiltersVisible=t},expression:"isFiltersVisible"}},[e._v("\n      Show Filters\n    ")]),e._v(" "),a("el-pagination",{attrs:{"page-size":e.pageSize,total:e.count,"page-sizes":e.pageSizes,"current-page":e.page,layout:"sizes, prev, pager, next"},on:{"update:currentPage":function(t){e.page=t},"current-change":function(t){e.update()},"size-change":function(t){e.pageSize=t,e.update()}}})],1),e._v(" "),a("div",{staticClass:"mb-2",staticStyle:{width:"50%"}},[e._v("\n    Params\n    "),e._l(e.params,(function(t,n){return a("div",{key:n,staticClass:"d-flex align-items-center mb-1"},[a("el-checkbox",{staticClass:"mr-2",model:{value:t.isEnabled,callback:function(a){e.$set(t,"isEnabled",a)},expression:"parameter.isEnabled"}}),e._v(" "),a("el-input",{attrs:{placeholder:"key"},on:{input:function(t){e.handleParamKeyChange(n)}},model:{value:t.key,callback:function(a){e.$set(t,"key",a)},expression:"parameter.key"}}),e._v(" "),a("el-input",{staticClass:"ml-1",attrs:{placeholder:"value"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"parameter.value"}}),e._v(" "),e.params.length>1?a("el-button",{attrs:{icon:"el-icon-close",circle:"",type:"text"},on:{click:function(t){e.removeParam(n)}}}):e._e()],1)})),e._v(" "),a("el-button",{staticClass:"btn btn-primary mb-3",on:{click:e.update}},[e._v("\n      Search\n    ")])],2),e._v(" "),a("el-table",{attrs:{data:e.tableRows,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""},on:{"sort-change":e.handleSortChange}},e._l(e.selectedColumns,(function(t,n){return a("el-table-column",{key:t,attrs:{label:t,prop:t,align:"center",sortable:e.sortableFieldTypes.includes(e.getFieldType(t))?"custom":void 0},scopedSlots:e._u([{key:"default",fn:function(l){return[0===l.$index&&e.isFiltersVisible?a("div",{staticClass:"text-left"},[a("el-input",{attrs:{placeholder:"Search by "+t,type:"number"===e.getFieldType(t)?"number":"text"},on:{change:function(t){e.update()}},model:{value:e.searchFilters[t],callback:function(a){e.$set(e.searchFilters,t,a)},expression:"searchFilters[name]"}}),e._v(" "),a("el-checkbox",{staticClass:"mt-3",attrs:{disabled:"number"===e.getFieldType(t)},on:{change:function(t){e.update()}},model:{value:e.exactSearches[t],callback:function(a){e.$set(e.exactSearches,t,a)},expression:"exactSearches[name]"}},[e._v("\n            Exact match\n          ")])],1):[0===n&&"requestlog"!==e.collectionName?a("router-link",{attrs:{to:"/edit/"+e.collectionName+"/"+l.row._id}},[e._v("\n            "+e._s(e.getPath(l.row,t))+"\n          ")]):e._e(),e._v(" "),0===n&&"requestlog"===e.collectionName?a("router-link",{attrs:{to:"/dev/viewrequest/"+l.row._id}},[e._v("\n            "+e._s(e.getPath(l.row,t))+"\n          ")]):e._e(),e._v(" "),0!==n?a("span",[e._v(e._s(e.getPath(l.row,t)))]):e._e()]]}}])})}))),e._v(" "),a("div",{staticClass:"d-flex align-items-center my-3"},[e.showAddButton?a("router-link",{staticClass:"mr-2",attrs:{to:"/edit/"+e.collectionName+"/create"}},[a("button",{staticClass:"btn btn-primary"},[e._v("\n        Add\n      ")])]):e._e(),e._v(" "),a("button",{staticClass:"btn btn-secondary download-button mr-2",on:{click:function(t){e.downloadCSV()}}},[e._v("\n      Download\n    ")]),e._v(" "),a("button",{staticClass:"btn btn-secondary download-button",on:{click:function(t){e.downloadAllCSV()}}},[e._v("\n      Download All\n    ")]),e._v(" "),a("span",{staticClass:"mx-auto"}),e._v(" "),a("el-pagination",{attrs:{"page-size":e.pageSize,total:e.count,"page-sizes":e.pageSizes,"current-page":e.page,layout:"sizes, prev, pager, next"},on:{"update:currentPage":function(t){e.page=t},"current-change":function(t){e.update()},"size-change":function(t){e.pageSize=t,e.update()}}})],1)],1)},l=[]},hm90:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return l}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"px-3"},[a("div",{staticClass:"d-flex align-items-start py-2"},[a("div",[e._v("\n      Endpoint\n\n      "),a("div",{staticClass:"d-flex align-items-center mb-2"},[a("el-input",{attrs:{placeholder:"key"},model:{value:e.apiBaseUrl,callback:function(t){e.apiBaseUrl=t},expression:"apiBaseUrl"}}),e._v(" "),a("el-input",{model:{value:e.apiSuffix,callback:function(t){e.apiSuffix=t},expression:"apiSuffix"}})],1),e._v("\n\n      Params\n      "),e._l(e.params,(function(t,n){return a("div",{key:n,staticClass:"d-flex align-items-center mb-1"},[a("el-checkbox",{staticClass:"mr-2",model:{value:t.isEnabled,callback:function(a){e.$set(t,"isEnabled",a)},expression:"parameter.isEnabled"}}),e._v(" "),a("el-input",{attrs:{placeholder:"key"},on:{input:function(t){e.handleParamKeyChange(n)}},model:{value:t.key,callback:function(a){e.$set(t,"key",a)},expression:"parameter.key"}}),e._v(" "),a("el-input",{staticClass:"ml-1",attrs:{placeholder:"value"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"parameter.value"}}),e._v(" "),e.params.length>1?a("el-button",{attrs:{icon:"el-icon-close",circle:"",type:"text"},on:{click:function(t){e.removeParam(n)}}}):e._e()],1)}))],2),e._v(" "),a("span",{staticClass:"mx-auto"}),e._v(" "),a("div",{staticClass:"d-flex align-items-center"},[a("el-dropdown",{staticClass:"mr-4",attrs:{multiple:"","hide-on-click":!1}},[a("span",{staticClass:"el-dropdown-link"},[e._v("\n          Select columns\n          "),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),a("el-dropdown-menu",{staticStyle:{"max-height":"300px",overflow:"auto"},attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-checkbox-group",{on:{input:e.update},model:{value:e.selectedColumns,callback:function(t){e.selectedColumns=t},expression:"selectedColumns"}},e._l(e.allPossibleColumns,(function(t){return a("el-dropdown-item",{key:t,attrs:{label:t,value:t}},[a("el-checkbox",{staticClass:"mb-0 mr-4",attrs:{label:t,disabled:1===e.selectedColumns.length&&e.selectedColumns[0]===t}})],1)})))],1)],1),e._v(" "),a("el-checkbox",{staticClass:"mb-0 mr-4",model:{value:e.isFiltersVisible,callback:function(t){e.isFiltersVisible=t},expression:"isFiltersVisible"}},[e._v("\n        Show Filters\n      ")]),e._v(" "),a("el-pagination",{attrs:{"page-size":e.pageSize,total:e.count,"page-sizes":e.pageSizes,"current-page":e.page,layout:"sizes, prev, pager, next"},on:{"update:currentPage":function(t){e.page=t},"current-change":function(t){e.update()},"size-change":function(t){e.pageSize=t,e.update()}}})],1)]),e._v(" "),a("el-button",{staticClass:"btn btn-primary mb-3",on:{click:e.update}},[e._v("\n    Search\n  ")]),e._v(" "),a("el-table",{attrs:{data:e.tableRows,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""},on:{"sort-change":e.handleSortChange}},e._l(e.selectedColumns,(function(t,n){return a("el-table-column",{key:t,attrs:{label:t,prop:t,align:"center",sortable:!0},scopedSlots:e._u([{key:"default",fn:function(n){return[a("div",{staticClass:"text-left"},[0===n.$index&&e.isFiltersVisible?a("div",[a("el-input",{attrs:{placeholder:"Search by "+t,type:"number"===e.getFieldType(t)?"number":"text"},on:{change:function(t){e.update()}},model:{value:e.searchFilters[t],callback:function(a){e.$set(e.searchFilters,t,a)},expression:"searchFilters[name]"}}),e._v(" "),a("el-checkbox",{staticClass:"mt-3",attrs:{disabled:"number"===e.getFieldType(t)},on:{change:function(t){e.update()}},model:{value:e.exactSearches[t],callback:function(a){e.$set(e.exactSearches,t,a)},expression:"exactSearches[name]"}},[e._v("\n              Exact match\n            ")])],1):e._e(),e._v(" "),a("span",[e._v(e._s(e.getPath(n.row,t)))])])]}}])})}))),e._v(" "),e.data.length?a("div",{staticClass:"d-flex align-items-center my-3"},[a("button",{staticClass:"btn btn-secondary download-button mr-2",on:{click:function(t){e.downloadCSV()}}},[e._v("\n      Download\n    ")]),e._v(" "),a("button",{staticClass:"btn btn-secondary download-button",on:{click:function(t){e.downloadAllCSV()}}},[e._v("\n      Download All\n    ")]),e._v(" "),a("span",{staticClass:"mx-auto"}),e._v(" "),a("el-pagination",{attrs:{"page-size":e.pageSize,total:e.count,"page-sizes":e.pageSizes,"current-page":e.page,layout:"sizes, prev, pager, next"},on:{"update:currentPage":function(t){e.page=t},"current-change":function(t){e.update()},"size-change":function(t){e.pageSize=t,e.update()}}})],1):e._e()],1)},l=[]},jbWL:function(e,t,a){"use strict";a.r(t);var n=a("hm90"),l=a("2dk7");for(var r in l)["default"].indexOf(r)<0&&function(e){a.d(t,e,(function(){return l[e]}))}(r);var s=a("KHd+"),i=Object(s.a)(l.default,n.a,n.b,!1,null,null,null);i.options.__file="Endpoints.vue",t.default=i.exports},lcJ3:function(e,t,a){},r5ur:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(a("14Xm")),l=f(a("GQeE")),r=f(a("m1cH")),s=f(a("jWXv")),i=f(a("rfXi")),o=f(a("EJiy")),c=f(a("QbLZ")),u=f(a("D3Ub")),d=f(a("VqTb")),p=f(a("t3Un"));function f(e){return e&&e.__esModule?e:{default:e}}var m=a("hLX6");m.keepArray=!0,t.default={name:"Endpoints",mixins:[d.default],data:function(){return{lastEndpoint:"",apiBaseUrl:p.default.defaults.baseURL,apiSuffix:""}},methods:{update:function(){var e=this;return(0,u.default)(n.default.mark((function t(){var a,u,d,f,h;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(;"/"===e.apiSuffix.charAt(0);)e.apiSuffix=e.apiSuffix.substring(1);if(e.apiSuffix){t.next=3;break}return t.abrupt("return");case 3:return a=e.apiBaseUrl+"/"+e.apiSuffix,a!==e.lastEndpoint&&(e.lastEndpoint=a,e.resetTable()),u=(0,c.default)({page:e.page,limit:e.pageSize},e.allFilters,{query:void 0}),d=e.customParams?"/"+e.apiSuffix+"?"+e.customParams:"/"+e.apiSuffix,t.next=10,(0,p.default)({url:d,params:u,baseURL:e.apiBaseUrl});case 10:f=t.sent.data,!f.page&&!f.itemsTotal&&(Array.isArray(f)||(f="object"!==(void 0===f?"undefined":(0,o.default)(f))?[{result:f}]:[f]),f={data:f,itemsTotal:1}),e.count=f.itemsTotal,e.data=e.applyCustomColumnFilter(f.data),e.selectedColumns.length||(h=(0,i.default)(e.data.reduce((function(e,t){var a=m.dot(t);return new s.default([].concat((0,r.default)((0,l.default)(a)),(0,r.default)(e)))}),[])),e.selectedColumns=h.slice(0,5),e.allPossibleColumns=h);case 16:case"end":return t.stop()}}),t,e)})))()},applyCustomColumnFilter:function(e){var t=this,a=(0,l.default)(this.searchFilters);return e.filter((function(e){return a.every((function(a){var n=t.searchFilters[a];if(!n)return!0;var l=m.dot(e)[a].toString();return t.exactSearches[a]?l.trim()===n.trim():l.toLowerCase().includes(n.toLowerCase())}))}))},downloadAllCSV:function(){var e=this;return(0,u.default)(n.default.mark((function t(){var a,l,s,i,o;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=[],l=1;case 2:if(!(e.count>a.length)){t.next=12;break}return s=(0,c.default)({},e.allFilters,{page:l,limit:500,query:void 0}),i="/"+e.apiSuffix+"?"+e.customParams,t.next=7,(0,p.default)({url:i,params:s});case 7:o=t.sent.data,a=[].concat((0,r.default)(o.data),(0,r.default)(a)),l+=1,t.next=2;break;case 12:e.downloadCSV(e.applyCustomColumnFilter(a));case 13:case"end":return t.stop()}}),t,e)})))()}}}},sw1Y:function(e,t,a){"use strict";a.r(t);var n=a("vRIL"),l=a.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(r);t.default=l.a},vRIL:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(a("FyfS")),l=h(a("jWXv")),r=h(a("rfXi")),s=h(a("14Xm")),i=h(a("D3Ub")),o=h(a("YEIV")),c=h(a("GQeE")),u=h(a("m1cH")),d=h(a("QbLZ")),p=h(a("t3Un")),f=h(a("Iab2")),m=h(a("boci"));function h(e){return e&&e.__esModule?e:{default:e}}var v=[25,50,100,500],g={order:null,prop:null};t.default={name:"ListDocuments",props:{collectionName:{type:String,default:"collection"},filter:{type:Object,default:function(){}},columns:{type:Array,default:function(){}},showAddButton:{type:Boolean,default:!0},showPaginateOnBottom:{type:Boolean,default:!0}},data:function(){return{page:1,count:0,data:[],schema:{},exactSearches:{},searchFilters:{},pageSizes:v,pageSize:v[0],isFiltersVisible:!0,sortableFieldTypes:["number","string","boolean"],orderBy:(0,d.default)({},g),selectedColumns:[],allPossibleColumns:[],params:[{key:"",value:"",isEnabled:!0}]}},computed:{isEndpointsPage:function(){return"Endpoints"===this.$options.name},tableRows:function(){return this.isFiltersVisible?[{}].concat((0,u.default)(this.data)):this.data},appliedSearchFilters:function(){var e=this;return(0,c.default)(this.searchFilters).reduce((function(t,a){var n=e.searchFilters[a],l=e.getFieldType(a);if(!n||"custom"===l)return t;var r=e.getQueryBuilder(l);return(0,d.default)({},t,(0,o.default)({},a,r({fieldName:a,searchKeyword:n})))}),{})},allFilters:function(){var e=this.isEndpointsPage?void 0:'{"meta.created":-1}';this.orderBy.prop&&this.orderBy.order&&(e='{"'+this.orderBy.prop+'": '+("descending"===this.orderBy.order?"-1":"1")+"}");var t=(0,d.default)({orderby:e,page:this.page,limit:this.pageSize},this.filter,{query:(0,d.default)({},this.appliedSearchFilters)}),a=this.selectedColumns;return a&&(t.fields=a.reduce((function(e,t){return e[t]=1,e}),{})),t},customParams:function(){return this.params.filter((function(e){return e.isEnabled&&e.key})).map((function(e){return e.key+"="+(e.value||"")})).join("&")||""}},watch:{collectionName:{handler:"update"},"$route.params.collectionName":{handler:"resetTable"}},mounted:function(){this.update()},methods:{getPath:function(e,t,a){var n=String.prototype.split.call(t,/[,[\].]+?/).filter(Boolean).reduce((function(e,t){return null!=e?e[t]:e}),e);return void 0===n||n===e?a:n},handleSortChange:function(e){this.orderBy=e,this.update()},update:function(){var e=this;return(0,i.default)(s.default.mark((function t(){var a,n,l,r;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.$route.params.collectionName&&(e.collectionName=e.$route.params.collectionName),e.collection&&e.collection._id===e.collectionName){t.next=6;break}return t.next=4,(0,p.default)({url:"/collection/"+e.collectionName});case 4:e.collection=t.sent.data,e.schema=e.collection.schema;case 6:return e.selectedColumns.length||(a=e.columns||e.collection.admin&&e.collection.admin.columns,e.allPossibleColumns=e.getAllPossibleColumns(),e.selectedColumns=a||(0,c.default)(e.schema.properties)),n=(0,d.default)({},e.allFilters),l=e.customParams?"/"+e.collectionName+"/?"+e.customParams:"/"+e.collectionName,t.next=11,(0,p.default)({url:l,params:n});case 11:r=t.sent.data,e.count=r.itemsTotal,e.data=e.applyCustomColumnFilter(r.data);case 14:case"end":return t.stop()}}),t,e)})))()},getAllPossibleColumns:function(){var e=this.collection.admin&&this.collection.admin.columns||[],t=this.getSchemaProperties(this.schema);return(0,r.default)(new l.default(e.concat(t).sort()))},getSchemaProperties:function(e,t){var a=this,n=[],l=e.properties;return(0,c.default)(l).forEach((function(e){var r=(t?t+".":"")+e;l[e].properties&&(0,c.default)(l[e].properties).length?n=n.concat(a.getSchemaProperties(l[e],r)):n.push(r)})),n},getSchemaProperty:function(e,t){var a=t.split("."),l=e,r=!0,s=!1,i=void 0;try{for(var o,c=(0,n.default)(a);!(r=(o=c.next()).done);r=!0){var u=o.value;if(!l.properties||!l.properties[u])return;l=l.properties[u]}}catch(e){s=!0,i=e}finally{try{!r&&c.return&&c.return()}finally{if(s)throw i}}return l},applyCustomColumnFilter:function(e){var t=this,a=(0,c.default)(this.searchFilters).filter((function(e){return"custom"===t.getFieldType(e)}));return e.filter((function(e){return a.every((function(a){var n=t.searchFilters[a];if(!n)return!0;var l=String(m.default.get(e,a)||"");return t.exactSearches[a]?l===n:l.toLowerCase().includes(n.toLowerCase())}))}))},downloadCSV:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.data,a=this.collectionName,n=this.selectedColumns.map((function(e){return'"'+e+'"'})).join(",")+"\n";if(t){n+=t.map((function(t){return e.selectedColumns.map((function(e){return'"'+String(m.default.get(t,e)||"").replace(/"/g,'""')+'"'}))})).join("\n"),console.log(n);var l=new Blob([n],{type:"text/plain;charset=utf-8"});(0,f.default)(l,a+".csv")}},downloadAllCSV:function(){var e=this;return(0,i.default)(s.default.mark((function t(){var a,n,l,r;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=[],n=1;case 2:if(!(e.count>a.length)){t.next=11;break}return l=(0,d.default)({},e.allFilters,{page:n,limit:500}),t.next=6,(0,p.default)({url:"/"+e.collectionName+"/"+e.customParams,params:l});case 6:r=t.sent.data,a=[].concat((0,u.default)(r.data),(0,u.default)(a)),n+=1,t.next=2;break;case 11:e.downloadCSV(e.applyCustomColumnFilter(a));case 12:case"end":return t.stop()}}),t,e)})))()},getFieldType:function(e){var t=this.getSchemaProperty(this.schema,e);return t&&t.type||"custom"},getQueryBuilder:function(e){return{string:this.getStringSearchQuery,number:function(e){return parseInt(e.searchKeyword)}}[e]||this.getStringSearchQuery},getStringSearchQuery:function(e){var t=e.fieldName,a=e.searchKeyword,n={$regex:a,$options:"i"};return this.exactSearches[t]?a:n},resetTable:function(){this.resetFilters(),this.resetPagination(),this.data=[],this.count=0},resetFilters:function(){this.exactSearches={},this.searchFilters={},this.selectedColumns=[],this.allPossibleColumns=[]},resetPagination:function(){this.page=1,this.pageSize=v[0],this.orderBy=g},handleParamKeyChange:function(e){var t=this.params[e].key;e===this.params.length-1&&t&&this.params.push({key:"",value:"",isEnabled:!0})},removeParam:function(e){this.params.splice(e,1)}}}}}]);